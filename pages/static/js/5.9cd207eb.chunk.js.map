{"version":3,"sources":["../node_modules/dayjs/plugin/advancedFormat.js","pages/item/ItemPopUp.js"],"names":["module","exports","e","t","r","n","prototype","s","format","en","ordinal","this","$locale","$utils","a","replace","Math","ceil","$M","$D","weekYear","isoWeekYear","week","isoWeek","String","$H","floor","$d","getTime","offsetName","bind","dayjs","extend","advancedFormat","ItemPopUp","item","showModal","setShowModal","onAdd","onTake","useState","loadingTransaction","setLoadingTransaction","hasMore","setHasMore","nodeRef","useRef","transactionContainerRef","transactions","setTransactions","currentPage","setCurrentPage","useInView","threshold","ref","inView","useEffect","axiosInstance","get","id","then","data","transaction","filter","v","i","find","el","has_more","catch","err","console","log","fetchTransaction","handleLoadMore","useCallback","page","in","timeout","unmountOnExit","classNames","closing","title","name","className","src","image","alt","barcode","description","quantity","onClick","undefined","map","isTrIn","transaction_code","date","created_at","store","IDRFormatter","price"],"mappings":"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","file":"static/js/5.9cd207eb.chunk.js","sourcesContent":["!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_advancedFormat=t()}(this,(function(){\"use strict\";return function(e,t,r){var n=t.prototype,s=n.format;r.en.ordinal=function(e){var t=[\"th\",\"st\",\"nd\",\"rd\"],r=e%100;return\"[\"+e+(t[(r-20)%10]||t[r]||t[0])+\"]\"},n.format=function(e){var t=this,r=this.$locale(),n=this.$utils(),a=(e||\"YYYY-MM-DDTHH:mm:ssZ\").replace(/\\[([^\\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case\"Q\":return Math.ceil((t.$M+1)/3);case\"Do\":return r.ordinal(t.$D);case\"gggg\":return t.weekYear();case\"GGGG\":return t.isoWeekYear();case\"wo\":return r.ordinal(t.week(),\"W\");case\"w\":case\"ww\":return n.s(t.week(),\"w\"===e?1:2,\"0\");case\"W\":case\"WW\":return n.s(t.isoWeek(),\"W\"===e?1:2,\"0\");case\"k\":case\"kk\":return n.s(String(0===t.$H?24:t.$H),\"k\"===e?1:2,\"0\");case\"X\":return Math.floor(t.$d.getTime()/1e3);case\"x\":return t.$d.getTime();case\"z\":return\"[\"+t.offsetName()+\"]\";case\"zzz\":return\"[\"+t.offsetName(\"long\")+\"]\";default:return e}}));return s.bind(this)(a)}}}));","import dayjs from \"dayjs\";\nimport advancedFormat from \"dayjs/plugin/advancedFormat\";\nimport { useRef, useState, useEffect, useCallback } from \"react\";\nimport { useInView } from \"react-intersection-observer\";\nimport { CSSTransition } from \"react-transition-group\";\nimport { Modal, LoadingSpinner } from \"../../components\";\nimport axiosInstance from \"../../utils/axiosInstance\";\nimport { IDRFormatter } from \"../../utils/CurrenyFormatter\";\n\ndayjs.extend(advancedFormat);\n\n/**\n * Modal for item detail including its transaction\n *\n * @param {Object} props Component props\n * @returns Modal component to be rendered\n */\nconst ItemPopUp = ({ item, showModal, setShowModal, onAdd, onTake }) => {\n  const [loadingTransaction, setLoadingTransaction] = useState(false);\n  const [hasMore, setHasMore] = useState(false);\n  const nodeRef = useRef();\n  const transactionContainerRef = useRef();\n  const [transactions, setTransactions] = useState([]);\n  const [currentPage, setCurrentPage] = useState(0);\n  const { ref, inView } = useInView({ threshold: 0 });\n\n  /**\n   * Handle Fetching Transaction Data.\n   * Fetch data on item selected changes,\n   * modal opened, or load more.\n   */\n  useEffect(() => {\n    const fetchTransaction = async () =>\n      await axiosInstance\n        .get(\n          `/transaction/byitem/${item?.id}?type=all&limit=20&page=${currentPage}`\n        )\n        .then(({ data }) => {\n          setTransactions((transaction) => [\n            ...transaction,\n            ...data.transactions.filter((v, i) => {\n              if (transaction.find((el) => el.id === v.id)) return false;\n              return v.id;\n            }),\n          ]);\n          setHasMore(data.has_more);\n          setLoadingTransaction(false);\n        })\n        .catch((err) => console.log(err));\n\n    // Only load data if this component is shown\n    if (showModal) {\n      fetchTransaction();\n    }\n  }, [currentPage, item, showModal]);\n\n  /**\n   * Determine if item has more transaction\n   * then load more transaction data if `true`\n   */\n  const handleLoadMore = useCallback(() => {\n    if (!loadingTransaction && hasMore) {\n      setLoadingTransaction(true);\n      setCurrentPage((page) => page + 1);\n    }\n  }, [loadingTransaction, hasMore]);\n\n  /**\n   * Checking if user reaching to the\n   * bottom of the data then calling\n   * `handleLoadMore` if its true\n   */\n  useEffect(() => {\n    if (inView) {\n      handleLoadMore();\n    }\n  }, [inView, handleLoadMore]);\n\n  /**\n   * Handling on this pop-up is closing\n   */\n  const handleModalClosing = () => {\n    setShowModal(false);\n    setHasMore(false);\n    setCurrentPage(0);\n    setTransactions([]);\n  };\n\n  /**\n   * Open AddForm on clicked\n   *\n   * @param {Event} e button click event\n   */\n  const handleAddButton = (e) => {\n    onAdd();\n  };\n\n  /**\n   * Open confirmation on taking item\n   *\n   * @param {Event} e button click event\n   */\n  const handleTakeButton = (e) => {\n    onTake();\n  };\n\n  return (\n    <CSSTransition\n      in={showModal}\n      timeout={300}\n      unmountOnExit\n      nodeRef={nodeRef}\n      classNames=\"modal-lg\"\n    >\n      <Modal ref={nodeRef} closing={handleModalClosing} title={item?.name}>\n        <div className=\"flex flex-col px-1\">\n          <div className=\"flex flex-row space-x-2\">\n            <div className=\"w-24 h-36 sm:w-36 sm:h-36 bg-gray-500 rounded-xl mr-2 overflow-hidden\">\n              <img\n                src={item?.image}\n                alt=\"\"\n                className=\"h-full w-full object-cover object-center\"\n              />\n            </div>\n            <div className=\"flex flex-col flex-1 text-gray-900 dark:text-gray-100\">\n              <div className=\"text-sm font-semibold\">{item?.barcode}</div>\n              <div className=\"text-xs flex-1\">{item?.description}</div>\n              <div className=\"w-full flex flex-row justify-between\">\n                <div className=\"text-base\">{item?.quantity} pcs</div>\n                <div className=\"space-x-2\">\n                  <button\n                    onClick={handleTakeButton}\n                    className=\"px-2 py-1 text-gray-900 font-medium bg-yellow-200 hover:bg-yellow-300 active:bg-yellow-100 transition duration-300 focus:outline-none text-sm rounded-lg\"\n                  >\n                    Take 1\n                  </button>\n                  <button\n                    onClick={handleAddButton}\n                    className=\"px-2 py-1 text-gray-900 font-medium bg-green-200 hover:bg-green-300 active:bg-green-100 transition duration-300 focus:outline-none text-sm rounded-lg\"\n                  >\n                    Add\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div\n            className={`h-80 max-h-80 relative bg-gray-300 dark:bg-gray-600 text-gray-900 dark:text-gray-100 mt-2 rounded-lg overflow-hidden`}\n            ref={transactionContainerRef}\n          >\n            {loadingTransaction ? (\n              <div className=\"inset-0 z-20 absolute backdrop-filter backdrop-blur-sm flex justify-center items-center\">\n                <LoadingSpinner />\n              </div>\n            ) : undefined}\n            <div className=\"h-full px-2 py-1 overflow-y-scroll\">\n              <table className=\"w-full\">\n                <tbody>\n                  {transactions.map((v, i) => {\n                    const isTrIn = v.transaction_code === \"ti\";\n                    const date = dayjs(v.created_at);\n                    return (\n                      <tr key={i}>\n                        <td>\n                          {isTrIn\n                            ? v.store?.name\n                            : `Used @ ${date.format(\"MMM Do, YY\")}`}\n                        </td>\n                        <td>\n                          {isTrIn\n                            ? IDRFormatter.format(v.price)\n                            : date.format(\"HH:mm:ss\")}\n                        </td>\n                      </tr>\n                    );\n                  })}\n                  <tr ref={ref}></tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </Modal>\n    </CSSTransition>\n  );\n};\n\nexport default ItemPopUp;\n"],"sourceRoot":""}