(this["webpackJsonpomahq-fe"]=this["webpackJsonpomahq-fe"]||[]).push([[7],{282:function(e,t,n){"use strict";n.r(t);var a=n(18),c=n.n(a),s=n(29),o=n(20),r=n(10),u=n(42),i=n(191),l=n(23),d=n(0),b=n(43),f=n(5),j=n(1),h=n(4),g=n(58),x=n(19),O=n(44),m=n(2),v=function(e){var t=e.showModal,n=e.setShowModal,a=e.editId,i=e.houseName,l=e.cleanOnOpen,d=e.setHouses,h=e.addAlert,v=e.onClose,p=Object(j.useRef)(null),w=Object(j.useRef)(),y=Object(j.useState)(i),N=Object(r.a)(y,2),k=N[0],S=N[1],C=Object(j.useState)(!1),H=Object(r.a)(C,2),M=H[0],E=H[1],A=Object(j.useState)(!1),P=Object(r.a)(A,2),q=P[0],F=P[1],R=Object(f.c)((function(e){return e.auth})),_=Object(j.useContext)(x.b),D=_.loadingProcess,I=_.loadingDone,z="HOME_FORM";Object(j.useEffect)((function(){l&&S(""),i&&S(i),F(!1)}),[t,l,i]),Object(j.useEffect)((function(){var e;t&&(null===w||void 0===w||null===(e=w.current)||void 0===e||e.focus())}),[t,w]);var B=function(){var e=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==k&&void 0!==k){e.next=3;break}return F(!0),e.abrupt("return",!1);case 3:if(E(!0),D(z),!a){e.next=10;break}return e.next=8,b.a.patch("/house/".concat(a),{name:k}).then((function(e){d((function(e){var t=Object(o.a)(e);return t.map((function(e,t){return e.id===a&&(e.name=k),e})),t})),h({message:"".concat(e.data.name," has been successfully saved"),title:"Success",type:"success"})})).catch((function(e){e.response?Object(O.a)(e.response,h):console.log(e)})).finally((function(){E(!1),n(!1),v()}));case 8:e.next=12;break;case 10:return e.next=12,b.a.post("/house",{name:k,owner_id:R.data.id}).then((function(e){e.data.edit=!1,d((function(t){return[].concat(Object(o.a)(t),[e.data])})),h({message:"".concat(e.data.name," has been successfully saved"),title:"Success",type:"success"})})).catch((function(e){e.response?Object(O.a)(e.response,h):console.log(e)})).finally((function(){E(!1),n(!1),v()}));case 12:return I(z),e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.jsx)(g.a,{in:t,timeout:300,unmountOnExit:!0,nodeRef:p,classNames:"modal",children:Object(m.jsx)(u.f,{width:"sm",ref:p,closing:function(){M||(n(!1),v())},title:a?"Edit House":"New House",children:Object(m.jsxs)("div",{className:"flex flex-col px-1",children:[Object(m.jsx)(u.d,{label:"House Name",children:Object(m.jsx)(u.c,{ref:w,requiredFail:q,placeholder:"House Name",disabled:M,onChange:function(e){S(e.target.value)},value:k})}),Object(m.jsx)("div",{className:"flex justify-end",children:M?Object(m.jsxs)("button",{className:"px-2 py-1 inline-flex items-center font-medium rounded duration-300 ease-in-out focus:outline-none\n              text-white bg-green-400 hover:bg-green-300 active:bg-green-500",children:[Object(m.jsxs)("svg",{className:"animate-spin mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[Object(m.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),Object(m.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing"]}):Object(m.jsx)("button",{onClick:B,className:"px-2 py-1 rounded font-medium duration-300 ease-in-out focus:outline-none\n                text-white bg-green-400 hover:bg-green-300 active:bg-green-500",children:"Save"})})]})})})};v.defaultProps={setShowModal:function(){},showModal:!1,houseName:"",editId:null,onClose:function(){},addAlert:function(){}};var p=v,w=n(30);t.default=function(){var e=Object(f.c)((function(e){return e.auth})),t=Object(h.g)(),n=Object(j.useState)([]),a=Object(r.a)(n,2),g=a[0],v=a[1],y=Object(j.useState)(!1),N=Object(r.a)(y,2),k=N[0],S=N[1],C=Object(j.useState)(!1),H=Object(r.a)(C,2),M=H[0],E=H[1],A=Object(j.useContext)(w.b).showAlert,P=Object(j.useContext)(x.b),q=P.loadingProcess,F=P.loadingDone,R=Object(j.useState)(null),_=Object(r.a)(R,2),D=_[0],I=_[1],z=function(e,t){e.preventDefault();var n=Object(o.a)(g);n.map((function(e,t){return e.edit=!1,e})),null!==t&&(n[t].edit=!1===n[t].edit),v(n)},B=function(e){A(e)},J=Object(j.useCallback)(Object(s.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return q("FETCH_HOUSES"),t.next=3,b.a.request("/house/byowner/".concat(e.data.id)).then((function(e){var t=e.data.houses;t.map((function(e,t){return e.edit=!1,e})),v(t),F("FETCH_HOUSES")})).catch((function(e){var t=e.response;Object(O.a)(t,A)}));case 3:case"end":return t.stop()}}),t)}))),[e.data.id,A,q,F]);return Object(j.useEffect)((function(){J()}),[J]),Object(j.useEffect)((function(){D&&E(!0)}),[D]),Object(m.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 min-h-screen",children:[Object(m.jsx)(u.g,{}),Object(m.jsx)("div",{className:"py-10 lg:py-16",children:Object(m.jsxs)("div",{className:"flex flex-wrap justify-center",children:[g.map((function(e,n){return Object(m.jsxs)("button",{onClick:e.edit?function(){I(e)}:function(){return n=e.id,void t.push("/house/".concat(n));var n},onContextMenu:function(e){return z(e,n)},onBlur:function(e){return z(e,null)},className:"w-32 h-32 m-2 lg:w-40 lg:h-40 shadow-lg  ".concat(e.edit?"text-yellow-400 hover:text-yellow-500":"text-blue-500 hover:text-blue-600"," rounded-lg bg-white hover:bg-gray-200 active:bg-gray-400 dark:bg-gray-800 dark:hover:bg-gray-600 dark:active:bg-gray-500 focus:outline-none flex flex-col items-center justify-around transition-colors duration-200 ease-in-out"),children:[Object(m.jsx)(d.b.Provider,{value:{className:"w-14 h-14 lg:w-20 lg:h-20"},children:e.edit?Object(m.jsx)(l.b,{}):Object(m.jsx)(i.a,{})}),Object(m.jsx)("span",{className:"text-base font-medium md:text-xl",children:e.name})]},n)})),Object(m.jsxs)("button",{onClick:function(){return S(!0)},className:"w-32 h-32 m-2 lg:w-40 lg:h-40 lg:m-2\n            text-gray-500 hover:text-gray-600 border-gray-200 bg-gray-100 active:bg-gray-300 active:border-gray-300 hover:bg-gray-200\n            dark:text-gray-100 dark:hover:text-gray-200 dark:border-gray-900 dark:bg-gray-700 dark:active:bg-gray-500 dark:hover:bg-gray-600\n            border-4 border-dashed rounded-lg flex flex-col items-center justify-around focus:outline-none transition-colors duration-200 ease-in-out",children:[Object(m.jsx)(d.b.Provider,{value:{className:"w-14 h-14 lg:w-20 lg:h-20"},children:Object(m.jsx)(l.e,{})}),Object(m.jsx)("span",{className:"text-base font-medium md:text-xl",children:"New House"})]})]})}),Object(m.jsx)(p,{setShowModal:S,showModal:k,cleanOnOpen:!0,setHouses:v,addAlert:B}),Object(m.jsx)(p,{setShowModal:E,showModal:M,editId:null===D||void 0===D?void 0:D.id,houseName:null===D||void 0===D?void 0:D.name,setHouses:v,addAlert:B,onClose:function(){I(null)}})]})}}}]);
//# sourceMappingURL=7.b59a6d33.chunk.js.map